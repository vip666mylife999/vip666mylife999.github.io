<!DOCTYPE html>
<html lang='en-US'>
<head>
<meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0">
<base href="https://vip666mylife999.github.io/">
<link rel="icon" href="assets/hcpp-icon.png">
<link rel="stylesheet" type="text/css" href="assets/style.css?v=26">
<link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
<title>h/cpp - std::span / gsl::span</title>
<meta name="description" content="">
<meta name="keyword" content="cpp view non-owning pointer size">
<meta name="author" content="André Müller">
<meta name="date" content="2021-01-31">
<meta name="copyright" content="2019-2021&ensp;André Müller">
<meta name="hcpp-page-category" content="cat-article">
<meta name="hcpp-tags" content="C++ C++20 article containers modern-C++ ranges std-containers std-library views ">
</head>
<body>
<div id="top-nav"><div id="titlebar" class="boxed-wide"><div id="main-branding">
<a href="index.html"  id="main-logo" title="home"><span class="hwide"><img src="assets/hcpp.svg" style="max-width:100%;height:40;"></img></span>
<span class="hslim"><img src="assets/hcpp-square.svg" style="max-width:100%;height:40;"></img></span></a>

<div id="main-title">
<a href="index.html"  title="home">hacking&nbsp;C++</a>
</div></div>
<div id="main-menu"><div class="entry "><a href="tags/news.html">News</a></div>
<div class="submenu "><a>Learning</a><div class="submenu-dropdown">
<a href="cpp/beginners_guide.html" >Beginner's Guide to C++</a>

<hr>

<a href="cpp/std/containers.html" >Standard Library Containers</a>


<a href="cpp/std/algorithms.html" >Standard Library Algorithms</a>

<hr>

<a href="cpp/cheat_sheets.html" >Infographics / Cheat Sheets</a>


<a href="tags/article.html" >All Articles</a>

<hr>

<a href="dev/web_learning.html" >Online Learning</a>


<a href="cpp/books.html" >Books</a>
</div></div>
<div class="submenu "><a>Links</a><div class="submenu-dropdown">
<a href="cpp/community.html" >Community Resources</a>


<a href="cpp/tools/ecosystem.html" >Tool Ecosystem</a>

<hr>

<a href="tags/list.html" >All Resource Lists</a>

<hr>

<a href="dev/vim_plugins.html" >VIM Plugins</a>
</div></div>
<div class="submenu "><a>About</a><div class="submenu-dropdown">
<a href="about.html" >Why &amp; Who</a>


<a href="privacy.html" >Privacy</a>
</div></div></div>
<div id="main-socialbar">
<a href="https://twitter.com/hackingcpp" ><span class="cat-twitter"></span></a>
</div>
<div class="navlinks" id="nav-path"></div>
<div id="searchbar"><div id="searchbox"><input id="search-input"></input>
<button id="search-clear"></button>
<button id="search-run"></button>
<button id="search-close"></button></div></div>
<div class="hamburger " id="main-hamburger"><button title=""></button><div class="hamburger-dropdown"><a class="nav-icon-collapse-all" onclick="collapse_all_major_folds()">Collapse <strong>All</strong> Levels</a>

<a class="nav-icon-collapse" onclick="collapse_major_folds()">Collapse Top Level</a>

<a class="nav-icon-expand" onclick="expand_major_folds()">Expand Top Level</a>

<a class="nav-icon-expand-all" onclick="expand_all_major_folds()">Expand <strong>All</strong> Levels</a>

<hr>

<a href="tags/news.html" class="cat-news" >News</a>


<a href="tags/featured.html" class="cat-featured" >Featured</a>


<a href="tags/article.html" class="cat-article" >Articles</a>


<a href="cpp/beginners_guide.html" class="cat-guide" >Beginner's Guide to C++</a>


<a href="tags/list.html" class="cat-list" >Lists</a>

<hr>

<a href="https://twitter.com/hackingcpp" ><span class="cat-twitter"></span> @hackingcpp</a>


<a href="about.html" class="cat-about" >About</a>


<a href="privacy.html" class="cat-contact" >Privacy</a>


<a href="index.html" class="cat-home" >Home</a>
</div></div></div>
<nav id="guide-bar" class="boxed-wide"></nav></div>
<div id="drawer-top" class="boxed-wide"><div id="search-results"><div id="search-header"><h1 class="cat-search" id="search-title"></h1></div>
<div id="search-locations"><ul class="resources" id="search-location-items"></ul></div>
<div id="search-footer"></div></div></div>

<div id="main-content" class="boxed-wide "><article class="boxed-normal ">
<header class="plain">
<h1>
<span class="hwide"><code>std::span</code>&thinsp;/&thinsp;<code>gsl::span</code></span><span class="hslim">std::span / gsl::span</span><span class="hnavi"><code>std::span</code></span></h1>
<nav id="page-navbar" class=""></nav>
</header>
<section class="main plain"><h2 class="hfold " open><span class="hwide">Replaces (Pointer, Length) Pairs</span>
<span class="hslim">Replaces (Pointer, Length)</span>
<span class="hnavi">What for?</span></h2>
<div class="content " ><div class="panel large"><ul>
<li>lightweight 
<small>(= cheap to copy, can be passed by value)</small></li>

<li>non-owning view
<small>(= not responsible for allocating or deleting memory)</small></li>

<li>of a contiguous memory block
<small>(of e.g., <code>std::vector</code>, C-array, &hellip;)</small></li></ul></div>
<div class="panel-col "{style=""><table class="vstriped"><tbody><tr><td><code>span&lt;int&gt;</code></td>
<td>sequence of integers whose values can be changed</td></tr>
<tr><td><code>span&lt;int&nbsp;<span class="e2">const</span>&gt;</code></td>
<td>sequence of integers whose values <span class="e2">can't</span> be changed</td></tr>
<tr><td><code>span&lt;int<span class="e2">,5</span>&gt;</code></td>
<td>sequence of exactly 5 integers 
<small>(number of values fixed at compile time)</small></td></tr></tbody></table></div>
<div class="panel "><img src="cpp/std/span_into_vector.svg" style="max-width:100%;width:100%;max-width:325px;"></img></div>
<div class="panel-fold minor" open><h3 class="nav-none">Span vs. C-Style (Pointer,Length)</h3></div>
<div class="panel extra-vspacing"><table class="fixed2col vtop"><tbody><tr><td><code>void <strong>foo</strong>(<span class="hslim-br"></span><span class="hslim"></span><span class="e2">span</span>&lt;int&gt;&nbsp;s);</code></td>
<td><code>void <strong>foo</strong>(<span class="hslim-br"></span><span class="hslim"></span>int<span class="e2">*</span>&nbsp;a, <span class="e2">int</span>&nbsp;n);</code></td></tr>
<tr><td><ul class="symbols ">
<li class="cat-positive">well-expressed intent:<br>
<code>foo</code> <span class="e2">accesses</span>
a sequence of ints and doesn't take ownership of memory</li></ul></td>
<td><ul class="symbols ">
<li class="cat-negative">ambiguous semantics:<br>
does <code>foo</code>
take ownership of the array (delete it afterwards)?</li></ul></td></tr>
<tr><td><ul class="symbols ">
<li class="cat-positive">1 parameter per data source &rArr;
easy to call correctly</li></ul></td>
<td><ul class="symbols ">
<li class="cat-negative">2 parameters per data source &rArr;
unnecessary confusion,
especially when functions take
multiple arrays</li></ul></td></tr>
<tr><td><ul class="symbols ">
<li class="cat-positive"><code>foo</code>'s implementation can use
standard library conforming interface:
<br>
<code>empty</code>, <code>size</code>,
range-based <code>for</code>,
<code>begin</code>, <code>end</code>, &hellip;</li></ul></td>
<td><ul class="symbols ">
<li class="cat-negative">ugly and error-prone code inside <code>foo</code>
that is specific to handling arrays:
2 parameters whose values can vary independently,
<code>nullptr</code>-checks, &hellip;</li></ul></td></tr></tbody></table></div></div>
<h2 class="hfold " open><span class="nav-none">Using Spans</span>
<span class="nav-only">Using</span></h2>
<div class="content " ><div class="panel "><h6><code><span class="c6">#include &lt;span&gt;</span></code>&emsp;<a class="lbl" href="https://en.cppreference.com/w/cpp/container/span">C++20</a></h6>
<h6><code><span class="c6">#include &lt;gsl/span&gt;</span></code>&emsp;<a class="lbl " href="tags/c++14.html">C++14</a> + <a class="lbl" href="https://github.com/isocpp/CppCoreGuidelines/blob/master/docs/gsl-intro.md#gslspan-what-is-gslspan-and-what-is-it-for">GSL</a></h6></div>
<div class="panel-fold " open><h3>As Parameter <small>(Primary Use Case)</small></h3></div>
<div class="panel hvtight bg-filled "><div class="panel cs-light ">
<pre class="notranslate"><code>void <strong>print_ints</strong>  (<span class="e1">span&lt;</span>int const<span class="e1">&gt;</span> s);
void <strong>print_chars</strong> (<span class="e1">span&lt;</span>char const<span class="e1">&gt;</span> s);
void <strong>modify_ints</strong> (<span class="e1">span&lt;</span>int<span class="e1">&gt;</span> s);</code></pre>
</div>
<div class="panel-fold " open><h5 class="nav-none">Call With Container/Range<span class="if-opened">:</span><span class="if-closed">&hellip;</span></h5></div>
<div class="panel cs-light ">
<pre class="notranslate"><code>std::vector&lt;int&gt; v {1,2,3,4};
<strong>print_ints</strong>( <span class="e2">v</span> );  
<hr>std::array&lt;int,3&gt; a {1,2,3};
<strong>print_ints</strong>( <span class="e2">a</span> );  
<hr>std::string s = "Some Text";
<strong>print_chars</strong>( <span class="e2">s</span> );  
<hr>std::string_view sv = s;  <span class="comment "><a class="lbl " href="tags/c++17.html">C++17</a></span>
<strong>print_chars</strong>( <span class="e2">sv</span> );</code></pre>
</div>
<div class="panel-fold " open><h5 class="nav-none">Call With Iterator Range<span class="if-opened">:</span><span class="if-closed">&hellip;</span></h5></div>
<div class="panel cs-light ">
<pre class="notranslate"><code>std::vector&lt;int&gt; v {1,2,3,4,5,6,7,8};
<hr><span class="comment ">// iterator range:</span>
<strong>print_ints</strong>( <span class="e1">{</span><span class="c2">begin(v)+</span><span class="e2">2</span><span class="e1">,</span> <span class="c2">end(v)</span><span class="e1">}</span> );  
<strong>print_ints</strong>( <span class="e1">{</span><span class="c2">begin(v)+</span><span class="e2">2</span><span class="e1">,</span> <span class="c2">begin(v)+</span><span class="e2">5</span><span class="e1">}</span> );  
<hr><span class="comment ">// iterator + length:</span>
<strong>print_ints</strong>( <span class="e1">{</span><span class="c2">begin(v)+</span><span class="e2">2</span><span class="e1">,</span> <span class="e2">3</span><span class="e1">}</span> );</code></pre>
</div>
<div class="panel-fold " open><h5 class="nav-none">Call With Stack-Array<span class="if-opened">:</span><span class="if-closed">&hellip;</span></h5></div>
<div class="panel cs-light ">
<pre class="notranslate"><code>int <span class="e2">a[100]</span>;  
<strong>print_ints</strong>( <span class="e2">a</span> );</code></pre>
</div>
<div class="panel-fold " open><h5 class="nav-none">Call With Poiner &amp; Length<span class="if-opened">:</span><span class="if-closed">&hellip;</span></h5></div>
<div class="panel cs-light ">
<pre class="notranslate"><code>auto n = get_number_of_elements();
auto p = get_pointer_to_memory();
<strong>print_ints</strong>( <span class="e1">{</span>p<span class="e1">,</span> n<span class="e1">}</span> );</code></pre>
</div>
<div class="panel "><p class="cat-good">A <code>span</code> decouples the storage strategy for sequential
data from code that only needs to access the elements in 
the sequence, but not alter its structure.</p></div></div>
<div class="panel-fold " open><h3>Size &amp; Data <span class="nav-none">Access</span></h3></div>
<div class="panel-col "{style=""><div class="panel cs-light ">
<pre class="notranslate"><code><span class="c6 ">std::</span>span&lt;int&gt; <span class="e2">s</span> = <span class="annotation">&hellip;</span>;
if (<span class="e2">s</span><span class="e1">.empty()</span>) return;
if (<span class="e2">s</span><span class="e1">.size()</span> &lt; 1024) { <span class="annotation">&hellip;</span> }
<span class="comment ">// spans in range-based for loops</span>
for (auto x <span class="e1">:</span> <span class="e2">s</span>) { <span class="annotation">&hellip;</span> }
<hr><span class="comment ">// indexed access</span>
<span class="e2">s</span><span class="e1">[</span>0<span class="e1">]</span> = 8;
if (<span class="e2">s</span><span class="e1">[</span>2<span class="e1">]</span> &gt; 0) { <span class="annotation">&hellip;</span> }
<hr><span class="comment ">// iterator access</span>
auto m1 = <span class="c6 ">std::</span>min_element(<span class="e2">s</span><span class="e1">.begin()</span>,&nbsp;<span class="e2">s</span><span class="e1">.end()</span>);
auto m2 = <span class="c6 ">std::</span>min_element(<span class="e1">begin(</span><span class="e2">s</span><span class="e1">)</span>,&nbsp;<span class="e1">end(</span><span class="e2">s</span><span class="e1">)</span>);
auto m3 = <span class="c6 ">std::</span><span class="c6 ">ranges::</span>min_element(<span class="e2">s</span>);  <span class="comment "><a class="lbl " href="tags/c++20.html">C++20</a></span></code></pre>
</div></div>
<div class="panel-fold " open><h3>Comparing <span class="nav-none">Spans</span></h3></div>
<div class="panel cs-light ">
<pre class="notranslate"><code><span class="c6 ">std::</span>vector&lt;int&gt; v {1,2,3,4};
<span class="c6 ">std::</span>vector&lt;int&gt; w {1,2,3,4};
<span class="c6 ">std::</span>span s1 {v};
<span class="c6 ">std::</span>span s2 {w};
bool values_same = s1 <span class="e1">==</span> s2;  <span class="comment ">// true</span>
bool memory_same <span class="hslim-br"></span><span class="hslim">  </span>= s1<span class="e1">.data()</span> <span class="e1">==</span> s2<span class="e1">.data()</span>;  <span class="comment ">// false</span></code></pre>
</div>
<div class="panel-fold " open><h3>Spans From Spans</h3></div>
<div class="panel cs-light ">
<pre class="notranslate"><code><span class="c6 ">std::</span>span&lt;<span class="annotation">&hellip;</span>&gt; <span class="e2">s</span> = <span class="annotation">&hellip;</span>;
auto first3elements = <span class="e2">s</span>.<span class="e1"><a href="https://en.cppreference.com/w/cpp/container/span/first" >first</a></span>(3);
auto last3elements  = <span class="e2">s</span>.<span class="e1"><a href="https://en.cppreference.com/w/cpp/container/span/last" >last</a></span>(3);
size_t offset = 2;
size_t count = 4;
auto subs = <span class="e2">s</span>.<span class="e1"><a href="https://en.cppreference.com/w/cpp/container/span/subspan" >subspan</a></span>(offset, count);
<hr><span class="c6 ">std::</span>span&lt;<span class="c6 ">std::</span><strong>byte const</strong>&gt; b = <span class="e2">s</span>.<span class="e1"><a href="https://en.cppreference.com/w/cpp/container/span/as_bytes" >as_bytes</a></span>();
<span class="c6 ">std::</span>span&lt;<span class="c6 ">std::</span><strong>byte</strong>&gt; wb = <span class="e2">s</span>.<span class="e1"><a href="https://en.cppreference.com/w/cpp/container/span/as_bytes" >as_writable_bytes</a></span>();</code></pre>
</div></div>
<h2 class="hfold " open><span class="hwide">Making Spans</span>
<span class="hslim">Making Spans</span>
<span class="hnavi">Making</span></h2>
<div class="content " ><div class="panel "><p class="cat-info">In C++20, <code>std::span</code>'s template parameters can
be deduced from the constructor arguments.</p></div>
<div class="panel-fold " open><h3 class="nav-none">View Container</h3></div>
<div class="panel cs-light ">
<pre class="notranslate"><code>std::vector&lt;int&gt;  <span class="e2">w</span> {0, 1, 2, 3, 4, 5, 6};
std::array&lt;int,4&gt; <span class="e2">a</span> {0, 1, 2, 3};
<hr>std::<span class="e1">span</span> sw1 { <span class="e2">w</span> };  <span class="comment "><a class="lbl" href="https://en.cppreference.com/w/cpp/container/span/span">C++20</a></span>
std::<span class="e1">span</span> sa1 { <span class="e2">a</span> };
<span class="comment ">// explicit read-only view:</span>
std::<span class="e1">span</span> sw2 { <span class="c6 ">std::</span><span class="e1">as_const(</span><span class="e2">w</span><span class="e1">)</span> };
<hr>gsl::span<span class="e1">&lt;int&gt;</span>   sw3 { <span class="e2">w</span> };  <span class="comment "><a class="lbl" href="https://github.com/isocpp/CppCoreGuidelines/blob/master/docs/gsl-intro.md#gslspan-what-is-gslspan-and-what-is-it-for">GSL</a></span>
gsl::span<span class="e1">&lt;int,4&gt;</span> sa2 { <span class="e2">a</span> };  
<span class="comment ">// explicit read-only view:</span>
gsl::span<span class="e1">&lt;int const&gt;</span> sw4 { <span class="e2">a</span> };</code></pre>
</div>
<div class="panel-fold " open><h3 class="nav-none"><span class="hwide">View Container Subsequence</span>
<span class="hslim">View Subsequence</span></h3></div>
<div class="panel cs-light ">
<pre class="notranslate"><code>std::vector&lt;int&gt; w {0, 1, <span class="e2">2, 3, 4, 5, 6</span>};
<span class="comment ">                          |----.------'</span>
std::<span class="e1">span</span>      s1 <span class="e1">{</span><span class="e2">begin(w)+2, 5</span><span class="e1">}</span>;  <span class="comment "><a class="lbl" href="https://en.cppreference.com/w/cpp/container/span/span">C++20</a></span>
std::<span class="e1">span</span>      s2 <span class="e1">{</span><span class="e2">begin(w)+2, end(w)</span><span class="e1">}</span>; 

gsl::<span class="e1">span&lt;int&gt;</span> s3 <span class="e1">{</span><span class="e2">begin(w)+2, 5</span><span class="e1">}</span>;  <span class="comment "><a class="lbl" href="https://github.com/isocpp/CppCoreGuidelines/blob/master/docs/gsl-intro.md#gslspan-what-is-gslspan-and-what-is-it-for">GSL</a></span>
gsl::<span class="e1">span&lt;int&gt;</span> s4 <span class="e1">{</span><span class="e2">begin(w)+2, end(w)</span><span class="e1">}</span>;</code></pre>
</div>
<div class="panel-fold " open><h3 class="nav-none">View C-Array On Stack</h3></div>
<div class="panel cs-light ">
<pre class="notranslate"><code>int a[100];  
<span class="comment ">// auto-deduces type + size</span>
std::<span class="e1">span</span> s1 <span class="e1">{</span> a <span class="e1">}</span>;  <span class="comment "><a class="lbl" href="https://en.cppreference.com/w/cpp/container/span/span">C++20</a></span>
<hr><span class="comment ">// no parameter deduction</span>
gsl::<span class="e1">span&lt;int&gt;</span>     s2 <span class="e1">{</span> a <span class="e1">}</span>;  <span class="comment "><a class="lbl" href="https://github.com/isocpp/CppCoreGuidelines/blob/master/docs/gsl-intro.md#gslspan-what-is-gslspan-and-what-is-it-for">GSL</a></span>
gsl::<span class="e1">span&lt;int,100&gt;</span> s2 <span class="e1">{</span> a <span class="e1">}</span>;  <span class="comment ">// constexpr size</span></code></pre>
</div>
<div class="panel-fold " open><h3 class="nav-none">View C-Array On Heap</h3></div>
<div class="panel cs-light ">
<pre class="notranslate"><code>auto len = get_length_at_runtime();
auto p = <span class="c6 ">std::</span>make_unique&lt;int[]&gt;(len);  
std::<span class="e1">span</span>      s1 <span class="e1">{</span>p.get(), len<span class="e1">}</span>;  <span class="comment "><a class="lbl" href="https://en.cppreference.com/w/cpp/container/span/span">C++20</a></span>
gsl::<span class="e1">span&lt;int&gt;</span> s2 <span class="e1">{</span>p.get(), len<span class="e1">}</span>;  <span class="comment "><a class="lbl" href="https://github.com/isocpp/CppCoreGuidelines/blob/master/docs/gsl-intro.md#gslspan-what-is-gslspan-and-what-is-it-for">GSL</a></span></code></pre>
</div></div>
<h2 class="hfold " open>Careful!</h2>
<div class="content " ><div class="panel-fold " open><h3 class="nav-none"><span class="cat-warning"></span> Span Might Outlive Memory</h3></div>
<div class="panel cs-light ">
<pre class="notranslate"><code><span class="c6 ">std::</span>span s;
if ( <span class="annotation">&hellip;</span> ) {
  <span class="c6 ">std::</span>vector&lt;int&gt; w {1,2,3,4,5};
  s = <span class="c6 ">std::</span>span(w);
<span class="e1"></span>} <span class="comment ">// w destroyed!</span>
cout &lt;&lt; s[0]; <span class="comment ">// <span class="sym-problem"></span><span class="hwide e-err"> UNDEFINED BEHAVIOR:</span> <span class="c-err">w's memory destroyed!</span></span></code></pre>
</div>
<div class="panel-fold " open><h3 class="nav-none"><span class="cat-warning"></span> Memory Invalidation By Owner</h3></div>
<div class="panel-col "{style=""><div class="panel "><p>Containers like <code>vector</code> might allocate new memory thus
invalidating all views of it.</p></div>
<div class="panel cs-light ">
<pre class="notranslate"><code><span class="c6 ">std::</span>vector&lt;int&gt; w {1,2,3,4,5};
<span class="c6 ">std::</span>span s {w};
<span class="e1">w.insert</span>(begin(w), {-1,-2,0});
cout &lt;&lt; s[0]; <span class="comment ">// <span class="sym-problem"></span><span class="hwide e-err"> UNDEFINED BEHAVIOR:</span> <span class="c-err">w might hold new memory</span></span></code></pre>
</div></div></div>
<h2 class="hfold " open><span class="nav-none">Usage Guidelines</span>
<span class="nav-only">Guidelines</span></h2>
<div class="content " ><div class="panel-fold " open><h3 class="cat-good"><span class="hwide">Primary Use Case: As Function Parameter</span>
<span class="hslim">As Function Parameter</span>
<span class="hnavi">As Parameter</span></h3></div>
<div class="panel-col "{style=""><div class="panel "><ul class="symbols ">
<li class="cat-positive">span decouples function implementations from the data 
represenation&thinsp;/&thinsp;container type</li>

<li class="cat-positive">clearly communicates the intent of only reading/altering elements
in a sequence, but not modifying the underlying memory/data structure</li>

<li class="cat-positive">makes it easy to apply functions to sequence subranges</li>

<li class="cat-positive">can almost never be dangling, i.e., 
refer to memory that has already been destroyed
(because parameters outlive all function-local variables)</li>

<li class="cat-positive">a span's target cannot invalidate the memory that the span refers to
during the function's execution (unless it is done in another thread)</li></ul></div>
<div class="panel cs-light ">
<pre class="notranslate"><code>int <strong>foo</strong>(<span class="c6 ">std::</span>span&lt;int const&gt; in) { &hellip; }
<hr><span class="c6 ">std::</span>vector&lt;int&gt; v {&hellip;};
foo(v);
foo(<strong>{</strong>begin(v), 5});
<span class="comment ">// even passing a temporary vector is ok</span>
<span class="comment ">// because it will outlive the view parameter:</span>
foo(<span class="c6 ">std::</span>vector&lt;int&gt;{1,2,3,4});</code></pre>
</div></div>
<div class="panel-fold " open><h3 class="cat-bad"><span class="nav-none">Avoid Returning Spans</span>
<span class="nav-only">Avoid Returning</span></h3></div>
<div class="panel hvtight bg-filled "><div class="panel "><ul class="symbols ">
<li class="cat-negative">easy to produce dangling spans</li>

<li class="cat-negative">not always clear what object/memory the span refers to</li></ul></div>
<div class="panel cs-light ">
<pre class="notranslate"><code><span class="comment ">// which parameter is the span's target?</span>
<span class="c6 ">std::</span>span&lt;int const&gt;
<strong>foo</strong>(<span class="c6 ">std::</span>vector&lt;int&gt;&nbsp;const&amp;&nbsp;x, <span class="c6 ">std::</span>vector&lt;int&gt;&nbsp;const&amp;&nbsp;y);</code></pre>
</div>
<div class="panel cs-light ">
<pre class="notranslate"><code><span class="comment ">// we can assume that the returned span</span>
<span class="comment ">// refers to elements of the vector</span>
<span class="c6 ">std::</span>span&lt;int const&gt; <strong>samples</strong>(<span class="c6 ">std::</span>vector&lt;int&gt;&nbsp;const&amp;&nbsp;v, int&nbsp;n);
<span class="comment ">// however, this is still problematic:</span>
auto s = samples(vector&lt;int&gt;{1,2,3,4}, 2);
<span class="comment ">// <span class="sym-err"></span> <span class="e-err">'s' is dangling - vector object already destroyed!</span></span></code></pre>
</div>
<div class="panel cs-light ">
<pre class="notranslate"><code>class <strong>Payments</strong> { <span class="annotation">&hellip;</span>
public:
  <span class="c6 ">std::</span>span&lt;Money&nbsp;const&gt; <strong>of</strong>(Customer&nbsp;const&amp;)&nbsp;const;
  <span class="annotation">&hellip;</span>
};
<hr>Customer const&amp; john = &hellip;;
Payments pms = read_payments(file1);
auto m = pms.of(john);
pms <span class="e1">=</span> read_payments(file2);
<span class="comment ">// depending on the implementation of Payments</span>
<span class="comment ">// m's target memory might no longer be valid</span>
<span class="comment ">// after the assignment</span></code></pre>
</div></div>
<div class="panel-fold " open><h3 class="cat-bad"><span class="nav-none">Avoid Local Span Variables</span>
<span class="nav-only">Avoid As Variables</span></h3></div>
<div class="panel-col "{style=""><div class="panel "><ul class="symbols ">
<li class="cat-negative">easy to produce dangling spans, because we have to
manually track lifetimes to ensure that no span outlives its target</li>

<li class="cat-negative">even if the memory owner is still alive, it might invalidate
the memory which a span is referring to</li></ul></div>
<div class="panel cs-light ">
<pre class="notranslate"><code><span class="c6 ">std::</span>vector&lt;int&gt; v1 {1,2,3};
<span class="c6 ">std::</span>span s {v1};
if ( <span class="annotation">&hellip;</span> ) {
  <span class="c6 ">std::</span>string v2 = <span class="c6 ">std::</span>vector&lt;int&gt;{4,5,6};
  s = v2;
<span class="e1"></span>}
cout &lt;&lt; s; <span class="comment ">// <span class="sym-problem"></span> <span class="e-err">v2 already destroyed!</span></span></code></pre>
</div></div></div></section>
<section class="epilog">
<div class="panel-fold " open><h3 class="cat-link">Related <span class="if-closed">&hellip;</span></h3></div>
<div class="panel "><ul class="resources ">
<li class="cat-cppreference"><a href="https://en.cppreference.com/w/cpp/container/span"><code>std::span</code></a> &nbsp; <a class="lbl" href="https://en.cppreference.com/w/cpp/container/span">C++20</a></li>

<li class="cat-cppreference"><a href="https://github.com/isocpp/CppCoreGuidelines/blob/master/docs/gsl-intro.md#gslspan-what-is-gslspan-and-what-is-it-for"><code>gsl::span</code></a> &nbsp; <a class="lbl " href="tags/c++14.html">C++14</a> + <a class="lbl" href="https://github.com/isocpp/CppCoreGuidelines/blob/master/docs/gsl-intro.md#gslspan-what-is-gslspan-and-what-is-it-for">GSL</a></li>
<li class="cat-isostd"><a href="http://eel.is/c++draft/views"><code>std::span</code> ISO Standard Draft Chapter</a></li>
</ul></div>
</section>
<section class="context">
<ul class="linear-tags "><li><a href="tags/c++.html">C++</a></li><li><a href="tags/c++20.html">C++20</a></li><li><a href="tags/article.html">article</a></li><li><a href="tags/containers.html">containers</a></li><li><a href="tags/modern-c++.html">modern-C++</a></li><li><a href="tags/ranges.html">ranges</a></li><li><a href="tags/std-containers.html">std-containers</a></li><li><a href="tags/std-library.html">std-library</a></li><li><a href="tags/views.html">views</a></li></ul>
</section>
<section class="metadata">
<p><span class="cat-date">Last updated: 2020-09-20</span></p>
</section>
</article></div>
<footer>
<div id="footer-top"><div id="footer-top-content"><div id="footer-top-left"><nav><ul class="plain ">
<li>
<a href="index.html" class="cat-home" >Home</a>
</li>

<li>
<a href="tags/news.html" class="cat-news" >News</a>
</li>

<li>
<a href="tags/article.html" class="cat-article" >Articles</a>
</li>

<li>
<a href="tags/featured.html" class="cat-featured" >Featured</a>
</li>

<li>
<a href="tags/guide.html" class="cat-guide" >Guides</a>
</li>

<li>
<a href="tags/list.html" class="cat-list" >Lists</a>
</li>

<li>
<a href="about.html" class="cat-about" >About</a>
</li>

<li>
<a href="privacy.html" class="cat-contact" >Privacy</a>
</li>

<li>
<a href="https://twitter.com/hackingcpp" class="cat-twitter" >Twitter</a>
</li></ul></nav></div>
<div id="footer-top-right"><h2 class="cat-tags nav-none">
<a href="tags.html" >Tags</a>
</h2>
<ul class="topic-cloud "><li><a style="font-size:119.09832775265055%;" href="tags/algorithms.html">algorithms</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/allocators.html">allocators</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/arrays.html">arrays</a></li> <li><a style="font-size:155.67625418551208%;" href="tags/article.html">article</a></li> <li><a style="font-size:151.4520701280242%;" href="tags/beginner-level.html">beginner-level</a></li> <li><a style="font-size:60.0%;" href="tags/blogs.html">blogs</a></li> <li><a style="font-size:60.0%;" href="tags/books.html">books</a></li> <li><a style="font-size:60.0%;" href="tags/build-systems.html">build-systems</a></li> <li><a style="font-size:160.9530933887302%;" href="tags/c++.html">C++</a></li> <li><a style="font-size:60.0%;" href="tags/c++-standardization.html">C++-standardization</a></li> <li><a style="font-size:122.76135311474769%;" href="tags/c++11.html">C++11</a></li> <li><a style="font-size:112.96632221214513%;" href="tags/c++14.html">C++14</a></li> <li><a style="font-size:104.32374581448789%;" href="tags/c++17.html">C++17</a></li> <li><a style="font-size:109.08009883059783%;" href="tags/c++20.html">C++20</a></li> <li><a style="font-size:60.0%;" href="tags/c++98.html">C++98</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/c-style.html">C-style</a></li> <li><a style="font-size:60.0%;" href="tags/c-vs-c++.html">C-vs-C++</a></li> <li><a style="font-size:60.0%;" href="tags/cat-casts.html">cat-casts</a></li> <li><a style="font-size:106.83431667163975%;" href="tags/classes.html">classes</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/code-editors.html">code-editors</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/code-formatters.html">code-formatters</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/command-line.html">command-line</a></li> <li><a style="font-size:106.83431667163975%;" href="tags/community.html">community</a></li> <li><a style="font-size:60.0%;" href="tags/comparisons.html">comparisons</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/compilers.html">compilers</a></li> <li><a style="font-size:60.0%;" href="tags/concepts.html">concepts</a></li> <li><a style="font-size:60.0%;" href="tags/conferences.html">conferences</a></li> <li><a style="font-size:60.0%;" href="tags/const.html">const</a></li> <li><a style="font-size:60.0%;" href="tags/constexpr.html">constexpr</a></li> <li><a style="font-size:111.11165590902733%;" href="tags/containers.html">containers</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/control-flow.html">control-flow</a></li> <li><a style="font-size:114.67244982290701%;" href="tags/custom-types.html">custom-types</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/data-structures.html">data-structures</a></li> <li><a style="font-size:60.0%;" href="tags/debugging.html">debugging</a></li> <li><a style="font-size:104.32374581448789%;" href="tags/design.html">design</a></li> <li><a style="font-size:106.83431667163975%;" href="tags/diagnostics.html">diagnostics</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/exceptions.html">exceptions</a></li> <li><a style="font-size:89.54916387632527%;" href="tags/featured.html">featured</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/file-io.html">file-io</a></li> <li><a style="font-size:60.0%;" href="tags/find.html">find</a></li> <li><a style="font-size:60.0%;" href="tags/find_if.html">find_if</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/functional-prog.html">functional-prog</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/functions.html">functions</a></li> <li><a style="font-size:60.0%;" href="tags/gallery.html">gallery</a></li> <li><a style="font-size:94.30551689243521%;" href="tags/generic-prog.html">generic-prog</a></li> <li><a style="font-size:60.0%;" href="tags/groups.html">groups</a></li> <li><a style="font-size:60.0%;" href="tags/guide.html">guide</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/guidelines.html">guidelines</a></li> <li><a style="font-size:60.0%;" href="tags/hash-map.html">hash-map</a></li> <li><a style="font-size:60.0%;" href="tags/hash-set.html">hash-set</a></li> <li><a style="font-size:60.0%;" href="tags/hashing.html">hashing</a></li> <li><a style="font-size:60.0%;" href="tags/header-files.html">header-files</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/heap.html">heap</a></li> <li><a style="font-size:60.0%;" href="tags/ides.html">ides</a></li> <li><a style="font-size:98.1917402739825%;" href="tags/idiom.html">idiom</a></li> <li><a style="font-size:98.1917402739825%;" href="tags/io.html">io</a></li> <li><a style="font-size:94.30551689243521%;" href="tags/iostreams.html">iostreams</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/iterators.html">iterators</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/language-mechanism.html">language-mechanism</a></li> <li><a style="font-size:60.0%;" href="tags/language-references.html">language-references</a></li> <li><a style="font-size:60.0%;" href="tags/learning.html">learning</a></li> <li><a style="font-size:60.0%;" href="tags/libraries.html">libraries</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/linker.html">linker</a></li> <li><a style="font-size:130.25147500745962%;" href="tags/list.html">list</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/low-level.html">low-level</a></li> <li><a style="font-size:60.0%;" href="tags/map.html">map</a></li> <li><a style="font-size:109.08009883059783%;" href="tags/memory.html">memory</a></li> <li><a style="font-size:120.39055466724817%;" href="tags/modern-c++.html">modern-C++</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/move-semantics.html">move-semantics</a></li> <li><a style="font-size:126.83373677211958%;" href="tags/news.html">news</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/oop.html">oop</a></li> <li><a style="font-size:60.0%;" href="tags/organizations.html">organizations</a></li> <li><a style="font-size:60.0%;" href="tags/package-manager.html">package-manager</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/paradigm.html">paradigm</a></li> <li><a style="font-size:60.0%;" href="tags/pattern.html">pattern</a></li> <li><a style="font-size:60.0%;" href="tags/people.html">people</a></li> <li><a style="font-size:60.0%;" href="tags/podcasts.html">podcasts</a></li> <li><a style="font-size:60.0%;" href="tags/pointers.html">pointers</a></li> <li><a style="font-size:60.0%;" href="tags/preprocessor.html">preprocessor</a></li> <li><a style="font-size:60.0%;" href="tags/profiling.html">profiling</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/randomness.html">randomness</a></li> <li><a style="font-size:60.0%;" href="tags/ranges.html">ranges</a></li> <li><a style="font-size:60.0%;" href="tags/references.html">references</a></li> <li><a style="font-size:60.0%;" href="tags/set.html">set</a></li> <li><a style="font-size:60.0%;" href="tags/social-media.html">social-media</a></li> <li><a style="font-size:60.0%;" href="tags/sorted-sequences.html">sorted-sequences</a></li> <li><a style="font-size:89.54916387632527%;" href="tags/stack.html">stack</a></li> <li><a style="font-size:60.0%;" href="tags/standardization.html">standardization</a></li> <li><a style="font-size:116.25207726360686%;" href="tags/std-algorithms.html">std-algorithms</a></li> <li><a style="font-size:89.54916387632527%;" href="tags/std-containers.html">std-containers</a></li> <li><a style="font-size:128.6110337848704%;" href="tags/std-library.html">std-library</a></li> <li><a style="font-size:60.0%;" href="tags/std-macros.html">std-macros</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/std-vector.html">std-vector</a></li> <li><a style="font-size:60.0%;" href="tags/strings.html">strings</a></li> <li><a style="font-size:60.0%;" href="tags/style.html">style</a></li> <li><a style="font-size:60.0%;" href="tags/taste.html">taste</a></li> <li><a style="font-size:83.41715833581988%;" href="tags/templates.html">templates</a></li> <li><a style="font-size:60.0%;" href="tags/testing.html">testing</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/toolchain.html">toolchain</a></li> <li><a style="font-size:116.25207726360686%;" href="tags/tools.html">tools</a></li> <li><a style="font-size:74.77458193816263%;" href="tags/traversal.html">traversal</a></li> <li><a style="font-size:117.72267522825506%;" href="tags/types.html">types</a></li> <li><a style="font-size:60.0%;" href="tags/user.html">user</a></li> <li><a style="font-size:60.0%;" href="tags/version-control.html">version-control</a></li> <li><a style="font-size:60.0%;" href="tags/views.html">views</a></li> <li><a style="font-size:60.0%;" href="tags/vim.html">VIM</a></li> <li><a style="font-size:60.0%;" href="tags/vim-plugins.html">VIM-plugins</a></li> <li><a style="font-size:60.0%;" href="tags/warnings.html">warnings</a></li> <li><a style="font-size:114.67244982290701%;" href="tags/websites.html">websites</a></li> 
</ul></div></div></div>
<div id="footer-bottom"><div id="footer-bottom-content">&copy;&nbsp;2019-2021&ensp;André&nbsp;Müller&emsp;&emsp;</div></div>
</footer>
<script src="assets/content.js?v=26"></script>
</body>
</html>